---
interface Props {
  noScroll?: boolean
}

const {noScroll} = Astro.props

const navLinks = {
  1: {
    href: '/#about',
    text: 'О нас',
  },
  2: {
    href: '/contacts/',
    text: 'Контакты',
  },
}

export const grayBody = 'rounded-lg border-[1px] border-neutral-700 bg-[#111] text-neutral-500 text-white'
---

<header class="z-50 fixed left-[50%] top-12 flex w-fit -translate-x-[50%] items-center gap-6 p-2 text-base duration-300 sm:top-4 sm:justify-between sm:w-[90%]" class:list={[grayBody, noScroll && '!left-[49.57%]']}>
  <a href="/" class="mt-[2px] ml-2 text-lg font-bold uppercase sm:ml-0 text-neutral-500 hover:text-custom-yellow duration-200 sm:px-3 sm:py-1 sm:text-white">Аналитик</a>

  {
    Object.values(navLinks).map(({href, text}) => (
      <a {href} rel="nofollow" class="block overflow-hidden sm:hidden">
        <div class="h-[20px] hover:translate-y-[-20px] duration-300">
          <span class="flex h-[20px] items-center">{text}</span>
          <span class="flex h-[20px] items-center text-custom-yellow">{text}</span>
        </div>
      </a>
    ))
  }

  <button onclick="window.location.href = '/#consultation'" class="">Записаться</button>
</header>

<script>
  const header = document.querySelector('header')
  let scroll_time
  let scroll_pos = 0

  function hideHeader() {
    clearTimeout(scroll_time)
    const current_scroll = window.pageYOffset || document.documentElement.scrollTop

    if (header && current_scroll >= header.offsetHeight) {
      const shouldAddClass = current_scroll > scroll_pos
      header.classList.toggle('-translate-y-20', shouldAddClass)
    }

    scroll_time = setTimeout(() => {
      scroll_pos = window.pageYOffset || document.documentElement.scrollTop
    }, 100)
  }

  function isMobileDevice() {
    return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)
  }

  if (isMobileDevice()) {
    window.addEventListener('scroll', hideHeader)
  }
</script>

<style>
  button {
    @apply relative z-0 flex items-center gap-2 overflow-hidden whitespace-nowrap rounded-lg border-[1px]
         border-neutral-700 px-4 py-1.5 font-medium
         text-neutral-300  transition-all duration-300;
  }

  button:before {
    @apply absolute inset-0
           -z-10 translate-y-[200%]
           scale-[2.5]
           rounded-[100%] bg-custom-yellow
           transition-transform duration-1000
           content-[""];
  }

  button:hover {
    @apply scale-105 border-custom-yellow text-neutral-900;
  }

  button:hover:before {
    @apply translate-y-[0%];
  }

  button:active {
    @apply scale-100;
  }
</style>
